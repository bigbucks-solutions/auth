basePath: /api/v1
definitions:
  actions.UserListResponse:
    properties:
      page:
        type: integer
      page_size:
        type: integer
      total:
        type: integer
      users:
        items:
          $ref: '#/definitions/types.ListUserResponse'
        type: array
    type: object
  bigbucks_solution_auth_rest-api_controllers_types.Role:
    properties:
      description:
        type: string
      extraAttrs:
        additionalProperties: true
        type: object
      name:
        type: string
    required:
    - name
    type: object
  bigbucks_solution_auth_rest-api_controllers_types.UserInfo:
    properties:
      isSocialAccount:
        type: boolean
      organizations:
        items:
          $ref: '#/definitions/types.UserInfoOrganization'
        type: array
      profile:
        $ref: '#/definitions/types.UserInfoProfile'
      roles:
        items:
          $ref: '#/definitions/types.UserInfoRole'
        type: array
      username:
        type: string
    type: object
  constants.UserStatus:
    enum:
    - active
    - inactive
    - pending
    type: string
    x-enum-varnames:
    - UserStatusActive
    - UserStatusInactive
    - UserStatusPending
  controllers.AcceptInvitationResponse:
    properties:
      jwtToken:
        type: string
      message:
        type: string
    type: object
  controllers.InvitationResponse:
    properties:
      acceptedAt:
        type: string
      createdAt:
        type: string
      email:
        type: string
      expiresAt:
        type: string
      id:
        type: string
      inviter:
        $ref: '#/definitions/controllers.UserInfo'
      role:
        $ref: '#/definitions/controllers.RoleInfo'
      status:
        type: string
    type: object
  controllers.InviteUserRequest:
    properties:
      email:
        type: string
      roleId:
        type: string
    required:
    - email
    - roleId
    type: object
  controllers.JsonCred:
    properties:
      password:
        type: string
      recaptcha:
        type: string
      username:
        type: string
    type: object
  controllers.ListInvitationsResponse:
    properties:
      invitations:
        items:
          $ref: '#/definitions/controllers.InvitationResponse'
        type: array
      page:
        type: integer
      size:
        type: integer
      total:
        type: integer
    type: object
  controllers.RequestPasswordResetToken:
    properties:
      email:
        example: example@example.com
        type: string
    type: object
  controllers.ResetPassword:
    properties:
      email:
        type: string
      password:
        type: string
    type: object
  controllers.RoleInfo:
    properties:
      id:
        type: string
      name:
        type: string
    type: object
  controllers.UserInfo:
    properties:
      id:
        type: string
      username:
        type: string
    type: object
  controllers.webAuthnLoginRequest:
    properties:
      mediation:
        type: string
      username:
        type: string
    type: object
  protocol.AttestationFormat:
    enum:
    - packed
    - tpm
    - android-key
    - android-safetynet
    - fido-u2f
    - apple
    - none
    type: string
    x-enum-varnames:
    - AttestationFormatPacked
    - AttestationFormatTPM
    - AttestationFormatAndroidKey
    - AttestationFormatAndroidSafetyNet
    - AttestationFormatFIDOUniversalSecondFactor
    - AttestationFormatApple
    - AttestationFormatNone
  protocol.AuthenticationExtensions:
    additionalProperties: {}
    type: object
  protocol.AuthenticatorAttachment:
    enum:
    - platform
    - cross-platform
    type: string
    x-enum-varnames:
    - Platform
    - CrossPlatform
  protocol.AuthenticatorSelection:
    properties:
      authenticatorAttachment:
        allOf:
        - $ref: '#/definitions/protocol.AuthenticatorAttachment'
        description: |-
          AuthenticatorAttachment If this member is present, eligible authenticators are filtered to only
          authenticators attached with the specified AuthenticatorAttachment enum.
      requireResidentKey:
        description: |-
          RequireResidentKey this member describes the Relying Party's requirements regarding resident
          credentials. If the parameter is set to true, the authenticator MUST create a client-side-resident
          public key credential source when creating a public key credential.
        type: boolean
      residentKey:
        allOf:
        - $ref: '#/definitions/protocol.ResidentKeyRequirement'
        description: |-
          ResidentKey this member describes the Relying Party's requirements regarding resident
          credentials per Webauthn Level 2.
      userVerification:
        allOf:
        - $ref: '#/definitions/protocol.UserVerificationRequirement'
        description: |-
          UserVerification This member describes the Relying Party's requirements regarding user verification for
          the create() operation. Eligible authenticators are filtered to only those capable of satisfying this
          requirement.
    type: object
  protocol.AuthenticatorTransport:
    enum:
    - usb
    - nfc
    - ble
    - smart-card
    - hybrid
    - internal
    type: string
    x-enum-varnames:
    - USB
    - NFC
    - BLE
    - SmartCard
    - Hybrid
    - Internal
  protocol.ConveyancePreference:
    enum:
    - none
    - indirect
    - direct
    - enterprise
    type: string
    x-enum-varnames:
    - PreferNoAttestation
    - PreferIndirectAttestation
    - PreferDirectAttestation
    - PreferEnterpriseAttestation
  protocol.CredentialAssertion:
    properties:
      mediation:
        $ref: '#/definitions/protocol.CredentialMediationRequirement'
      publicKey:
        $ref: '#/definitions/protocol.PublicKeyCredentialRequestOptions'
    type: object
  protocol.CredentialCreation:
    properties:
      mediation:
        $ref: '#/definitions/protocol.CredentialMediationRequirement'
      publicKey:
        $ref: '#/definitions/protocol.PublicKeyCredentialCreationOptions'
    type: object
  protocol.CredentialDescriptor:
    properties:
      id:
        description: CredentialID The ID of a credential to allow/disallow.
        items:
          type: integer
        type: array
      transports:
        description: The authenticator transports that can be used.
        items:
          $ref: '#/definitions/protocol.AuthenticatorTransport'
        type: array
      type:
        allOf:
        - $ref: '#/definitions/protocol.CredentialType'
        description: The valid credential types.
    type: object
  protocol.CredentialMediationRequirement:
    enum:
    - ""
    - silent
    - optional
    - conditional
    - required
    type: string
    x-enum-varnames:
    - MediationDefault
    - MediationSilent
    - MediationOptional
    - MediationConditional
    - MediationRequired
  protocol.CredentialParameter:
    properties:
      alg:
        $ref: '#/definitions/webauthncose.COSEAlgorithmIdentifier'
      type:
        $ref: '#/definitions/protocol.CredentialType'
    type: object
  protocol.CredentialType:
    enum:
    - public-key
    type: string
    x-enum-varnames:
    - PublicKeyCredentialType
  protocol.PublicKeyCredentialCreationOptions:
    properties:
      attestation:
        $ref: '#/definitions/protocol.ConveyancePreference'
      attestationFormats:
        items:
          $ref: '#/definitions/protocol.AttestationFormat'
        type: array
      authenticatorSelection:
        $ref: '#/definitions/protocol.AuthenticatorSelection'
      challenge:
        items:
          type: integer
        type: array
      excludeCredentials:
        items:
          $ref: '#/definitions/protocol.CredentialDescriptor'
        type: array
      extensions:
        $ref: '#/definitions/protocol.AuthenticationExtensions'
      hints:
        items:
          $ref: '#/definitions/protocol.PublicKeyCredentialHints'
        type: array
      pubKeyCredParams:
        items:
          $ref: '#/definitions/protocol.CredentialParameter'
        type: array
      rp:
        $ref: '#/definitions/protocol.RelyingPartyEntity'
      timeout:
        type: integer
      user:
        $ref: '#/definitions/protocol.UserEntity'
    type: object
  protocol.PublicKeyCredentialHints:
    enum:
    - security-key
    - client-device
    - hybrid
    type: string
    x-enum-varnames:
    - PublicKeyCredentialHintSecurityKey
    - PublicKeyCredentialHintClientDevice
    - PublicKeyCredentialHintHybrid
  protocol.PublicKeyCredentialRequestOptions:
    properties:
      allowCredentials:
        items:
          $ref: '#/definitions/protocol.CredentialDescriptor'
        type: array
      challenge:
        items:
          type: integer
        type: array
      extensions:
        $ref: '#/definitions/protocol.AuthenticationExtensions'
      hints:
        items:
          $ref: '#/definitions/protocol.PublicKeyCredentialHints'
        type: array
      rpId:
        type: string
      timeout:
        type: integer
      userVerification:
        $ref: '#/definitions/protocol.UserVerificationRequirement'
    type: object
  protocol.RelyingPartyEntity:
    properties:
      id:
        description: A unique identifier for the Relying Party entity, which sets
          the RP ID.
        type: string
      name:
        description: |-
          A human-palatable name for the entity. Its function depends on what the PublicKeyCredentialEntity represents:

          When inherited by PublicKeyCredentialRpEntity it is a human-palatable identifier for the Relying Party,
          intended only for display. For example, "ACME Corporation", "Wonderful Widgets, Inc." or "ОАО Примертех".

          When inherited by PublicKeyCredentialUserEntity, it is a human-palatable identifier for a user account. It is
          intended only for display, i.e., aiding the user in determining the difference between user accounts with similar
          displayNames. For example, "alexm", "alex.p.mueller@example.com" or "+14255551234".
        type: string
    type: object
  protocol.ResidentKeyRequirement:
    enum:
    - discouraged
    - preferred
    - required
    type: string
    x-enum-varnames:
    - ResidentKeyRequirementDiscouraged
    - ResidentKeyRequirementPreferred
    - ResidentKeyRequirementRequired
  protocol.UserEntity:
    properties:
      displayName:
        description: |-
          A human-palatable name for the user account, intended only for display.
          For example, "Alex P. Müller" or "田中 倫". The Relying Party SHOULD let
          the user choose this, and SHOULD NOT restrict the choice more than necessary.
        type: string
      id:
        description: |-
          ID is the user handle of the user account entity. To ensure secure operation,
          authentication and authorization decisions MUST be made on the basis of this id
          member, not the displayName nor name members. See Section 6.1 of
          [RFC8266](https://www.w3.org/TR/webauthn/#biblio-rfc8266).
      name:
        description: |-
          A human-palatable name for the entity. Its function depends on what the PublicKeyCredentialEntity represents:

          When inherited by PublicKeyCredentialRpEntity it is a human-palatable identifier for the Relying Party,
          intended only for display. For example, "ACME Corporation", "Wonderful Widgets, Inc." or "ОАО Примертех".

          When inherited by PublicKeyCredentialUserEntity, it is a human-palatable identifier for a user account. It is
          intended only for display, i.e., aiding the user in determining the difference between user accounts with similar
          displayNames. For example, "alexm", "alex.p.mueller@example.com" or "+14255551234".
        type: string
    type: object
  protocol.UserVerificationRequirement:
    enum:
    - required
    - preferred
    - discouraged
    type: string
    x-enum-comments:
      VerificationPreferred: This is the default.
    x-enum-descriptions:
    - ""
    - This is the default.
    - ""
    x-enum-varnames:
    - VerificationRequired
    - VerificationPreferred
    - VerificationDiscouraged
  types.AuthorizeResponse:
    properties:
      status:
        type: boolean
    type: object
  types.CheckPermissionBody:
    properties:
      action:
        type: string
      orgID:
        type: integer
      resource:
        type: string
      scope:
        type: string
    type: object
  types.CreatePermissionBody:
    properties:
      action:
        minLength: 3
        type: string
      resource:
        minLength: 3
        type: string
      scope:
        minLength: 3
        type: string
    required:
    - action
    - resource
    - scope
    type: object
  types.ListRolePermission:
    properties:
      action:
        type: string
      isHidden:
        type: boolean
      isLocked:
        type: boolean
      resource:
        type: string
      scope:
        type: string
    type: object
  types.ListRoleResponse:
    properties:
      description:
        type: string
      extraAttrs:
        additionalProperties: true
        type: object
      id:
        type: string
      name:
        type: string
      userCount:
        type: integer
    type: object
  types.ListRolesPagedResponse:
    properties:
      page:
        type: integer
      roles:
        items:
          $ref: '#/definitions/types.ListRoleResponse'
        type: array
      size:
        type: integer
      total:
        type: integer
    type: object
  types.ListUserResponse:
    properties:
      activeSessions:
        type: integer
      email:
        type: string
      firstName:
        type: string
      id:
        type: string
      lastLogin:
        type: string
      lastName:
        type: string
      roles:
        items:
          $ref: '#/definitions/types.RoleWithId'
        type: array
      status:
        $ref: '#/definitions/constants.UserStatus'
      username:
        type: string
    type: object
  types.RolePermissionBindingBody:
    properties:
      action:
        type: string
      resource:
        type: string
      role_id:
        type: string
      scope:
        type: string
    type: object
  types.RoleWithId:
    properties:
      id:
        type: string
      name:
        type: string
    type: object
  types.SignupRequestBody:
    properties:
      email:
        type: string
      firstName:
        type: string
      lastName:
        type: string
      password:
        minLength: 6
        type: string
    required:
    - email
    - firstName
    - lastName
    - password
    type: object
  types.SimpleResponse:
    properties:
      message:
        example: message
        type: string
    type: object
  types.UserInfoOrganization:
    properties:
      id:
        type: string
      name:
        type: string
    type: object
  types.UserInfoProfile:
    properties:
      avatar:
        type: string
      bio:
        type: string
      country:
        type: string
      designation:
        type: string
      email:
        type: string
      firstName:
        type: string
      lastName:
        type: string
      phone:
        type: string
      timezone:
        type: string
    type: object
  types.UserInfoRole:
    properties:
      description:
        type: string
      extraAttrs:
        additionalProperties: true
        type: object
      name:
        type: string
    required:
    - name
    type: object
  types.UserRoleBindingBody:
    properties:
      orgId:
        type: string
      roleId:
        type: string
      userId:
        type: string
    required:
    - orgId
    - roleId
    - userId
    type: object
  webauthncose.COSEAlgorithmIdentifier:
    enum:
    - -7
    - -8
    - -35
    - -36
    - -37
    - -38
    - -39
    - -47
    - -257
    - -258
    - -259
    - -65535
    type: integer
    x-enum-varnames:
    - AlgES256
    - AlgEdDSA
    - AlgES384
    - AlgES512
    - AlgPS256
    - AlgPS384
    - AlgPS512
    - AlgES256K
    - AlgRS256
    - AlgRS384
    - AlgRS512
    - AlgRS1
host: localhost:8000
info:
  contact:
    email: jamsheed@nsmail.dev
    name: Jamsheed
    url: http://www.swagger.io/support
  description: This is REST api definitions.
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  termsOfService: http://swagger.io/terms/
  title: BigBucks Solutions Auth Engine
  version: 0.0.1
paths:
  /invitations:
    get:
      consumes:
      - application/json
      description: Get paginated list of invitations for the current organization
        with sorting support
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 10
        description: Page size
        in: query
        name: page_size
        type: integer
      - description: Filter by status (pending, accepted, expired, revoked)
        in: query
        name: status
        type: string
      - default: created_at
        description: Order by field (email, status, created_at, expires_at, role_name,
          inviter_name)
        in: query
        name: order_by
        type: string
      - default: desc
        description: Order direction (asc, desc)
        in: query
        name: order_dir
        type: string
      - description: Search term to filter by inviter or invitee email
        in: query
        name: search
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/controllers.ListInvitationsResponse'
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: List invitations for organization
      tags:
      - invitations
    post:
      consumes:
      - application/json
      description: Send an invitation to a user to join the organization with a specific
        role
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Invitation details
        in: body
        name: invitation
        required: true
        schema:
          $ref: '#/definitions/controllers.InviteUserRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Invitation sent successfully
          schema:
            $ref: '#/definitions/controllers.InvitationResponse'
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Invite user to organization
      tags:
      - invitations
  /invitations/{invitation_id}/resend:
    post:
      consumes:
      - application/json
      description: Resend an existing invitation or create a new one if expired
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Invitation ID
        in: path
        name: invitation_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Invitation resent
          schema:
            $ref: '#/definitions/controllers.InvitationResponse'
        "400":
          description: Bad request
          schema: {}
        "404":
          description: Not found
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Resend invitation
      tags:
      - invitations
  /invitations/{invitation_id}/revoke:
    put:
      consumes:
      - application/json
      description: Revoke a pending invitation
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Invitation ID
        in: path
        name: invitation_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Invitation revoked successfully
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "404":
          description: Invitation not found
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Revoke invitation
      tags:
      - invitations
  /invitations/accept:
    get:
      consumes:
      - application/json
      description: Accept an invitation to join an organization
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Invitation Token
        in: query
        name: token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Invitation accepted successfully
          schema:
            $ref: '#/definitions/controllers.AcceptInvitationResponse'
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "409":
          description: Conflict - Invitation already accepted
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Accept invitation
      tags:
      - invitations
  /master-data/actions:
    get:
      consumes:
      - application/json
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              type: string
            type: array
      summary: Get actions
      tags:
      - permissions
  /master-data/resources:
    get:
      consumes:
      - application/json
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              type: string
            type: array
      summary: Get resources
      tags:
      - permissions
  /master-data/scopes:
    get:
      consumes:
      - application/json
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              type: string
            type: array
      summary: Get scopes
      tags:
      - permissions
  /me:
    get:
      consumes:
      - application/json
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: User details
          schema:
            $ref: '#/definitions/bigbucks_solution_auth_rest-api_controllers_types.UserInfo'
        "400":
          description: ""
        "500":
          description: ""
      summary: Get logged in user profile information
      tags:
      - auth
  /permissions:
    post:
      consumes:
      - application/json
      description: Create a new permission in the system
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Permission object
        in: body
        name: permission
        required: true
        schema:
          $ref: '#/definitions/types.CreatePermissionBody'
      produces:
      - application/json
      responses:
        "201":
          description: Created
      summary: Create new permission
      tags:
      - permissions
  /roles:
    get:
      consumes:
      - application/json
      description: Get paginated list of roles with user count
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 10
        description: Page size
        in: query
        name: page_size
        type: integer
      - description: Filter by role name
        in: query
        name: role_name
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.ListRolesPagedResponse'
      summary: List roles
      tags:
      - roles
    post:
      consumes:
      - application/json
      description: Create a new role in the system
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Role object
        in: body
        name: role
        required: true
        schema:
          $ref: '#/definitions/bigbucks_solution_auth_rest-api_controllers_types.Role'
      produces:
      - application/json
      responses:
        "201":
          description: Created
      summary: Create new role
      tags:
      - roles
  /roles/{role_id}:
    delete:
      consumes:
      - application/json
      description: Delete an existing role if it has no associated users
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Role ID
        in: path
        name: role_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "400":
          description: Role has associated users
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "404":
          description: Role not found
          schema:
            $ref: '#/definitions/types.SimpleResponse'
      summary: Delete existing role
      tags:
      - roles
    put:
      consumes:
      - application/json
      description: Update an existing role in the system
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Role ID
        in: path
        name: role_id
        required: true
        type: string
      - description: Role object
        in: body
        name: role
        required: true
        schema:
          $ref: '#/definitions/bigbucks_solution_auth_rest-api_controllers_types.Role'
      produces:
      - application/json
      responses:
        "201":
          description: Created
      summary: Update existing role
      tags:
      - roles
  /roles/{role_id}/permissions:
    post:
      consumes:
      - application/json
      description: Lists permissions of a role
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Role ID
        in: path
        name: role_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/types.ListRolePermission'
            type: array
      summary: List permission of a role
      tags:
      - roles
  /roles/bind-permission:
    post:
      consumes:
      - application/json
      description: Associates a permission with a role
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Binding details
        in: body
        name: rolepermission
        required: true
        schema:
          $ref: '#/definitions/types.RolePermissionBindingBody'
      produces:
      - application/json
      responses:
        "200":
          description: Permission bound successfully
          schema:
            type: string
      summary: Bind permission to role
      tags:
      - roles
  /roles/bind-user:
    post:
      consumes:
      - application/json
      description: Associates a role with a user in an organization
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: User role binding details
        in: body
        name: binding
        required: true
        schema:
          $ref: '#/definitions/types.UserRoleBindingBody'
      produces:
      - application/json
      responses:
        "200":
          description: Role bound to user successfully
          schema:
            type: string
      summary: Bind role to user
      tags:
      - roles
  /roles/unbind-permission:
    post:
      consumes:
      - application/json
      description: Removes a permission with a role
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: UnBinding details
        in: body
        name: rolepermission
        required: true
        schema:
          $ref: '#/definitions/types.RolePermissionBindingBody'
      produces:
      - application/json
      responses:
        "200":
          description: Permission unbound successfully
          schema:
            type: string
      summary: UnBind permission to role
      tags:
      - roles
  /roles/unbind-user:
    post:
      consumes:
      - application/json
      description: Removes a role with a user in an organization
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: User role binding details
        in: body
        name: binding
        required: true
        schema:
          $ref: '#/definitions/types.UserRoleBindingBody'
      produces:
      - application/json
      responses:
        "200":
          description: Role bound to user successfully
          schema:
            type: string
      summary: UnBind role to user
      tags:
      - roles
  /sessions/{session_id}:
    delete:
      consumes:
      - application/json
      description: Revokes a specific session by session ID
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: Session ID to revoke
        in: path
        name: session_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: ""
        "404":
          description: ""
        "500":
          description: ""
      summary: Revoke a specific user session
      tags:
      - sessions
  /sessions/users/{user_id}:
    get:
      consumes:
      - application/json
      description: List User sessions for provided userId
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: User ID
        in: path
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: list of user sessions
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
        "400":
          description: ""
        "404":
          description: ""
        "500":
          description: ""
      summary: List User session for provided userId
      tags:
      - sessions
  /signin:
    post:
      consumes:
      - application/json
      description: Authenticate user with password and issue jwt token
      parameters:
      - description: request body
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.JsonCred'
      produces:
      - application/json
      responses:
        "200":
          description: JWT token
          schema:
            type: string
        "400":
          description: Bad request
          schema: {}
        "404":
          description: Not found
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Authenticate with username and pssword
      tags:
      - auth
  /signup:
    post:
      consumes:
      - application/json
      description: Create a new user account
      parameters:
      - description: User signup details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/types.SignupRequestBody'
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "400":
          description: Bad request
          schema: {}
        "404":
          description: Not found
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Register a new user
      tags:
      - auth
  /user/authorize:
    post:
      consumes:
      - application/json
      parameters:
      - description: request body
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/types.CheckPermissionBody'
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/types.AuthorizeResponse'
        "400":
          description: ""
        "500":
          description: ""
      summary: Check user have permission
      tags:
      - auth
  /user/changepassword/{token}:
    post:
      consumes:
      - application/json
      description: Reset the password with the password reset token sent to email
      parameters:
      - description: token
        in: path
        name: token
        required: true
        type: string
      - description: request body
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.ResetPassword'
      produces:
      - application/json
      responses:
        "200":
          description: ""
        "400":
          description: ""
        "404":
          description: ""
        "500":
          description: ""
      summary: Reset the password with the password reset token sent
      tags:
      - auth
  /user/reset:
    post:
      consumes:
      - application/json
      description: Get password reset token to email
      parameters:
      - description: request body
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/controllers.RequestPasswordResetToken'
      produces:
      - application/json
      responses:
        "200":
          description: return message
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "400":
          description: ""
        "404":
          description: ""
        "500":
          description: ""
      summary: Send the password reset token
      tags:
      - auth
  /user/updateprofile:
    post:
      consumes:
      - multipart/form-data
      description: Update user profile details
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: formData
        in: formData
        name: request
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: ""
        "400":
          description: ""
        "404":
          description: ""
        "500":
          description: ""
      summary: Update User profile details
      tags:
      - auth
  /users:
    get:
      consumes:
      - application/json
      description: Lists the users for an organization
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - default: 1
        description: Page number
        in: query
        name: page
        type: integer
      - default: 10
        description: Page size
        in: query
        name: page_size
        type: integer
      - description: Filter by role name
        in: query
        name: role_id
        type: string
      - description: Filter by organization ID
        in: query
        name: org_id
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/actions.UserListResponse'
      security:
      - JWTAuth: []
      - JWTAuth: []
      summary: Lists the users
      tags:
      - auth
  /users/{user_id}/activate:
    put:
      consumes:
      - application/json
      description: Activate a user in the organization
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: User ID
        in: path
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "400":
          description: Bad request
          schema: {}
        "404":
          description: User not found
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      security:
      - JWTAuth: []
      summary: Activate a user
      tags:
      - auth
  /users/{user_id}/deactivate:
    put:
      consumes:
      - application/json
      description: Deactivate a user in the organization
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: User ID
        in: path
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Success message
          schema:
            $ref: '#/definitions/types.SimpleResponse'
        "400":
          description: Bad request
          schema: {}
        "404":
          description: User not found
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      security:
      - JWTAuth: []
      summary: Deactivate a user
      tags:
      - auth
  /users/{user_id}/sessions:
    delete:
      consumes:
      - application/json
      description: Revokes all sessions for a user except the current session
      parameters:
      - description: Authorization
        in: header
        name: X-Auth
        required: true
        type: string
      - description: User ID
        in: path
        name: user_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: ""
        "404":
          description: ""
        "500":
          description: ""
      summary: Revoke all user sessions except current
      tags:
      - sessions
  /webauthn/check:
    get:
      description: Returns whether a given username has WebAuthn credentials registered
        (for login UI flow decisions).
      parameters:
      - description: Username to check
        in: query
        name: username
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: has_credentials
          schema:
            additionalProperties:
              type: boolean
            type: object
        "400":
          description: Bad request
          schema: {}
      summary: Check if user has WebAuthn credentials
      tags:
      - webauthn
  /webauthn/credentials:
    get:
      description: Returns all registered WebAuthn credentials for the authenticated
        user.
      produces:
      - application/json
      responses:
        "200":
          description: List of credentials
          schema:
            items:
              additionalProperties: true
              type: object
            type: array
        "401":
          description: Unauthorized
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      security:
      - JWTAuth: []
      summary: List WebAuthn credentials
      tags:
      - webauthn
  /webauthn/credentials/{credential_id}:
    delete:
      description: Removes a registered WebAuthn credential by ID.
      parameters:
      - description: Credential ID
        in: path
        name: credential_id
        required: true
        type: integer
      responses:
        "200":
          description: Deleted
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "404":
          description: Not found
          schema: {}
      security:
      - JWTAuth: []
      summary: Delete a WebAuthn credential
      tags:
      - webauthn
  /webauthn/login/begin:
    post:
      consumes:
      - application/json
      description: Starts the WebAuthn authentication ceremony. Pass username for
        credential-bound login, or omit for discoverable (passkey) login.
      parameters:
      - description: Optional username
        in: body
        name: request
        schema:
          $ref: '#/definitions/controllers.webAuthnLoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: WebAuthn assertion options
          schema:
            $ref: '#/definitions/protocol.CredentialAssertion'
        "400":
          description: Bad request
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Begin WebAuthn login
      tags:
      - webauthn
  /webauthn/login/finish:
    post:
      consumes:
      - application/json
      description: Completes the authentication ceremony, validates the authenticator
        response, and issues a JWT.
      parameters:
      - description: Username (must match begin request)
        in: query
        name: username
        type: string
      produces:
      - application/json
      responses:
        "202":
          description: JWT token
          schema:
            type: string
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      summary: Finish WebAuthn login
      tags:
      - webauthn
  /webauthn/register/begin:
    post:
      description: Starts the WebAuthn registration ceremony for the authenticated
        user. Returns a CredentialCreationOptions JSON for the browser.
      produces:
      - application/json
      responses:
        "200":
          description: WebAuthn creation options
          schema:
            $ref: '#/definitions/protocol.CredentialCreation'
        "401":
          description: Unauthorized
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      security:
      - JWTAuth: []
      summary: Begin WebAuthn credential registration
      tags:
      - webauthn
  /webauthn/register/finish:
    post:
      consumes:
      - application/json
      description: Completes the registration ceremony by validating the authenticator
        response and storing the credential.
      parameters:
      - description: Friendly name for the credential
        in: query
        name: name
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Credential registered
          schema:
            additionalProperties: true
            type: object
        "400":
          description: Bad request
          schema: {}
        "401":
          description: Unauthorized
          schema: {}
        "500":
          description: Internal server error
          schema: {}
      security:
      - JWTAuth: []
      summary: Finish WebAuthn credential registration
      tags:
      - webauthn
securityDefinitions:
  JWTAuth:
    in: header
    name: X-Auth
    type: apiKey
swagger: "2.0"
